{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Data\\Item/assets\\Script\\Data\\Item\\SellGoodFactory.js"],"names":["outModule","local","useSellGoodFunc","treat","person","sellGood","index","numArr","_functionNumArr","_nowHp","_maxHp","buildFunc","dayUpdate","personData","_overdueTime","_getTime","removeItemByItemId","_itemId","getItem","_overdueGood","use","g_LogTool","showLog","_name","_functionArr","forEach","oneData","type","itemId","sell","_money","_price","getSaveData","id","_id","getTime","judgeHaveFunctionByName","typeName","find","createOneSellGood","sellGoodId","parseInt","jsonData","g_JsonDataTool","getDataById","name","price","overdue","overdueGood","function","split","map","functionNum","str","getNewItemId","createOneSellGoodBySaveData","saveData","module","exports"],"mappings":"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","file":"SellGoodFactory.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Data\\Item","sourcesContent":["/**\r\n * 商品工厂\r\n */\r\nvar outModule = {};\r\nvar local = {};\r\n\r\nlocal.useSellGoodFunc = {};\r\n\r\n//治疗\r\nlocal.useSellGoodFunc.treat = function (person, sellGood, index) {\r\n    let numArr = sellGood._functionNumArr[index];\r\n    person._nowHp = person._nowHp + numArr[0];\r\n    if (person._nowHp > person._maxHp) {\r\n        person._nowHp = person._maxHp;\r\n    }\r\n};\r\n\r\n/**\r\n * @param sellGood 已经加好数据的商品，再增加一些操作函数\r\n */\r\nlocal.buildFunc = function (sellGood) {\r\n    /**\r\n     * 每天的更新函数\r\n     */\r\n    sellGood.dayUpdate = (personData) => {\r\n        if (sellGood._overdueTime !== -1) {\r\n            sellGood._getTime++;\r\n            if (sellGood._getTime >= sellGood._overdueTime) {\r\n                //转变物品\r\n                personData.removeItemByItemId(sellGood._itemId);\r\n                //新增一个物品\r\n                personData.getItem([sellGood._overdueGood, 1]);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 使用物品\r\n     */\r\n    sellGood.use = (personData) => {\r\n        g_LogTool.showLog(`${personData._name} 使用 ${sellGood._name}`);\r\n        sellGood._functionArr.forEach(function (oneData, index) {\r\n            if (local.useSellGoodFunc[oneData.type]) {\r\n                local.useSellGoodFunc[oneData.type](personData, sellGood, index);\r\n            }\r\n        });\r\n        //消耗物品\r\n        personData.removeItemByItemId(sellGood.itemId);\r\n    };\r\n\r\n    /**\r\n     * 出售物品\r\n     */\r\n    sellGood.sell = (personData) => {\r\n        personData._money = personData._money + sellGood._price;\r\n    };\r\n    //获取存储数据\r\n    sellGood.getSaveData = function () {\r\n        return {\r\n            id: sellGood._id,\r\n            itemId: sellGood._itemId,\r\n            getTime: sellGood._getTime\r\n        }\r\n    };\r\n    //判断物品是否有一个功能\r\n    sellGood.judgeHaveFunctionByName = function (typeName) {\r\n        return sellGood._functionArr.find(function (oneData) {\r\n            oneData.type === typeName;\r\n        });\r\n    };\r\n};\r\n\r\n/**\r\n * 新建一个商品\r\n */\r\nlocal.createOneSellGood = function (sellGoodId, personData) {\r\n    //存储id\r\n    this._itemId = parseInt(sellGoodId);\r\n    //数据\r\n    var jsonData = g_JsonDataTool.getDataById('_table_item_sellGood', sellGoodId);\r\n    //名字\r\n    this._name = jsonData.name;\r\n    //价格\r\n    this._price = jsonData.price;\r\n    //过期时间\r\n    this._overdueTime = jsonData.overdue;\r\n    //过期后转换成的物品\r\n    this._overdueGood = jsonData.overdueGood;\r\n    //功能\r\n    this._functionArr = jsonData.function ? ('' + jsonData.function).split(',') : [];\r\n    this._functionArr = this._functionArr.map(function (id) {\r\n        return g_JsonDataTool.getDataById('_table_item_itemFunction', id);\r\n    });\r\n    this._functionNumArr = jsonData.functionNum ? ('' + jsonData.functionNum).split(',') : [];\r\n    this._functionNumArr = this._functionNumArr.map(function (str) {\r\n        return ('' + str).split('/');\r\n    });\r\n    //唯一id\r\n    this._id = personData.getNewItemId();\r\n\r\n    //获得的时间\r\n    //单位是天\r\n    this._getTime = 0;\r\n\r\n    //新增函数\r\n    local.buildFunc(this);\r\n};\r\n\r\n/**\r\n * @param saveData 存储的数据\r\n */\r\nlocal.createOneSellGoodBySaveData = function (saveData) {\r\n    //存储id\r\n    this._itemId = parseInt(saveData.itemId);\r\n    //数据\r\n    var jsonData = g_JsonDataTool.getDataById('_table_item_sellGood', this._itemId);\r\n    //名字\r\n    this._name = jsonData.name;\r\n    //价格\r\n    this._price = jsonData.price;\r\n    //过期时间\r\n    this._overdueTime = jsonData.overdue;\r\n    //过期后转换成的物品\r\n    this._overdueGood = jsonData.overdueGood;\r\n    //功能\r\n    this._functionArr = jsonData.function ? ('' + jsonData.function).split(',') : [];\r\n    this._functionArr = this._functionArr.map(function (id) {\r\n        return g_JsonDataTool.getDataById('_table_item_itemFunction', id);\r\n    });\r\n    this._functionNumArr = jsonData.functionNum ? ('' + jsonData.functionNum).split(',') : [];\r\n    this._functionNumArr = this._functionNumArr.map(function (str) {\r\n        return ('' + str).split('/');\r\n    });\r\n    //唯一id\r\n    this._id = saveData.id;\r\n\r\n    //获得的时间\r\n    //单位是天\r\n    this._getTime = saveData.getTime;\r\n    //新增函数\r\n    local.buildFunc(this);\r\n};\r\n\r\n/**\r\n * @param sellGoodId 商品id\r\n * @param saveData 存储的数据\r\n */\r\noutModule.createOneSellGood = (sellGoodId, saveData, personData) => {\r\n    if (saveData) {\r\n        return new local.createOneSellGoodBySaveData(saveData);\r\n    }\r\n    return new local.createOneSellGood(sellGoodId, personData);\r\n};\r\n\r\nmodule.exports = outModule;"]}