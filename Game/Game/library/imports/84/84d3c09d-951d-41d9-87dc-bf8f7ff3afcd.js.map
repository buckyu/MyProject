{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Module\\Event/assets\\Script\\Module\\Event\\MapRandomEvent.js"],"names":["outModule","local","eventFuncObj","battle","personData","dataArr","g_BattleManager","startBattle","require","createOneBasePerson","undefined","judgeMapRandomEvent","cc","random0To1","g_JsonDataTool","getDataById","num","mapRandomEventData","getTableByName","mapRandomEventArr","array","i","len","length","randomNum","type","split","mapRandomEventCb","g_LogTool","showLog","_name","name","module","exports"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,YAAY,EAAhB;AACA,IAAIC,QAAQ,EAAZ;;AAEAA,MAAMC,YAAN,GAAqB,EAArB;;AAEAD,MAAMC,YAAN,CAAmBC,MAAnB,GAA4B,UAAUC,UAAV,EAAsBC,OAAtB,EAA+B;AACvDC,oBAAgBC,WAAhB,CAA4BH,UAA5B,EAAwCI,QAAQ,eAAR,EAAyBC,mBAAzB,CAA6CJ,QAAQ,CAAR,CAA7C,EAAyDK,SAAzD,EAAoEA,SAApE,CAAxC;AACH,CAFD;;AAIA;AACAV,UAAUW,mBAAV,GAAgC,UAAUP,UAAV,EAAsB;AAClD,QAAIQ,GAAGC,UAAH,MAAoBC,eAAeC,WAAf,CAA2B,2BAA3B,EAAwD,CAAxD,EAA2DC,GAA3D,GAAiE,GAAzF,EAA+F;AAC3F;AACH;AACD,QAAIC,qBAAqBH,eAAeI,cAAf,CAA8B,6BAA9B,CAAzB;AACA,QAAIC,oBAAoBF,qBAAqBA,mBAAmBG,KAAxC,GAAgD,EAAxE;AACA,QAAIC,UAAJ;AAAA,QAAOC,YAAP;AACA,SAAKD,IAAI,CAAJ,EAAOC,MAAMH,kBAAkBI,MAApC,EAA4CF,IAAIC,GAAhD,EAAqDD,GAArD,EAA0D;AACtD,YAAIG,YAAYL,kBAAkBE,CAAlB,EAAqBG,SAArB,GAAiC,GAAjD;AACA,YAAIZ,GAAGC,UAAH,KAAkBW,SAAtB,EAAiC;AAC7B;AACA,gBAAIvB,MAAMC,YAAN,CAAmBiB,kBAAkBE,CAAlB,EAAqBI,IAAxC,CAAJ,EAAmD;AAC/CxB,sBAAMC,YAAN,CAAmBiB,kBAAkBE,CAAlB,EAAqBI,IAAxC,EAA8CrB,UAA9C,EAA0D,CAAC,KAAKe,kBAAkBE,CAAlB,EAAqBL,GAA3B,EAAgCU,KAAhC,CAAsC,GAAtC,CAA1D;AACAtB,2BAAWuB,gBAAX;AACAC,0BAAUC,OAAV,CAAqBzB,WAAW0B,KAAhC,oBAAoDX,kBAAkBE,CAAlB,EAAqBU,IAAzE;AACA,uBAAO,IAAP;AACH;AACJ;AACJ;AACD,WAAO,KAAP;AACH,CApBD;;AAsBAC,OAAOC,OAAP,GAAiBjC,SAAjB","file":"MapRandomEvent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Module\\Event","sourcesContent":["/**\r\n * 大地图随机事件\r\n */\r\nvar outModule = {};\r\nvar local = {};\r\n\r\nlocal.eventFuncObj = {};\r\n\r\nlocal.eventFuncObj.battle = function (personData, dataArr) {\r\n    g_BattleManager.startBattle(personData, require('PersonFactory').createOneBasePerson(dataArr[0], undefined, undefined));\r\n};\r\n\r\n//判断会不会有随机事件\r\noutModule.judgeMapRandomEvent = function (personData) {\r\n    if (cc.random0To1() >= (g_JsonDataTool.getDataById('_table_Game_gameParameter', 1).num / 100)) {\r\n        return;\r\n    }\r\n    let mapRandomEventData = g_JsonDataTool.getTableByName('_table_event_mapRandomEvent');\r\n    let mapRandomEventArr = mapRandomEventData ? mapRandomEventData.array : [];\r\n    let i, len;\r\n    for (i = 0, len = mapRandomEventArr.length; i < len; i++) {\r\n        let randomNum = mapRandomEventArr[i].randomNum / 100;\r\n        if (cc.random0To1() < randomNum) {\r\n            //触发\r\n            if (local.eventFuncObj[mapRandomEventArr[i].type]) {\r\n                local.eventFuncObj[mapRandomEventArr[i].type](personData, ('' + mapRandomEventArr[i].num).split(','));\r\n                personData.mapRandomEventCb();\r\n                g_LogTool.showLog(`${personData._name} meet event ${mapRandomEventArr[i].name}`);\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\nmodule.exports = outModule;"]}