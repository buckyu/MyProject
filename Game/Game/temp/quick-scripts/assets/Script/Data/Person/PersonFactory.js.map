{"version":3,"sources":["PersonFactory.js"],"names":["outModule","local","RandomNameTool","require","ActionFactory","SellGoodFactory","MapRandomEvent","changeMapPos","person","addMinutes","_goalCityMapPos","g_GameTool","judgeEqualPos","_nowMapPos","judgeMapRandomEvent","moveNum","Math","ceil","_moveSpeed","disX","abs","x","disY","y","addX","addY","_pos","cityId","_goalCityId","undefined","judgeNextAction","_itemArr","length","g_GlobalData","MAX_ITEM_NUM","createOneAction","_power","MAX_POWER","cc","random0To1","buildFunc","goToCity","_inInBattle","cityMapPos","g_GameGlobalManager","gameData","getCityById","_cityPos","goToBuilding","buildingId","_homePos","nearCityData","getNearBuildingCity","_id","actionFinishCb","action","_nowAction","getItem","_rewardArr","_costPower","_money","_costMoney","g_LogTool","showLog","_name","rewardArr","i","j","id","num","sellData","createOneSellGood","push","timeUpdate","doAction","dayUpdate","forEach","oneSellGoodData","getNewItemId","_maxItemId","removeItemByItemId","itemId","len","index","_itemId","splice","sellGood","oneItemData","sell","getSaveData","name","attack","_attack","def","_def","command","_command","intelligence","_intelligence","charm","_charm","politics","_politics","maxHp","_maxHp","sex","_sex","moveSpeed","presonSkillId","_presonSkillId","battleSkillId","_battleSkillId","equipAttack","_equipAttack","equipDef","_equipDef","equipJewelry","_equipJewelry","equipHorse","_equipHorse","nowHp","_nowHp","pos","homePos","goalCityMapPos","nowMapPos","goalCityId","nowAction","itemArr","map","money","power","maxItemId","deadCb","personAttack","startBattleCb","battleFinishCb","MIN_HP_NUM","treat","judgeHaveFunctionByName","use","mapRandomEventCb","useHome","createOneBasePerson","personId","randomData","jsonData","g_JsonDataTool","getDataById","hp","getNewPersonId","createOneBasePersonBySaveData","saveData","_presonSkillIdArr","split","_battleSkillIdArr","oenData","createRandomPerson","SEX_MAN","getRandomName","module","exports"],"mappings":"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","file":"PersonFactory.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Data\\Person","sourcesContent":["/*global module, require, cc, client */\r\nvar outModule = {};\r\nvar local = {};\r\nvar RandomNameTool = require('RandomNameTool');\r\nvar ActionFactory = require('ActionFactory');\r\nvar SellGoodFactory = require('SellGoodFactory');\r\nvar MapRandomEvent = require('MapRandomEvent');\r\n\r\n/**\r\n * 改变人物大地图上的位置\r\n */\r\nlocal.changeMapPos = function (person, addMinutes) {\r\n    if (!person._goalCityMapPos) {\r\n        return;\r\n    }\r\n    if (!g_GameTool.judgeEqualPos(person._nowMapPos, person._goalCityMapPos)) {\r\n        //还没有到达目的地\r\n        if (MapRandomEvent.judgeMapRandomEvent(person)) {\r\n            return;\r\n        }\r\n        //移动的距离\r\n        let moveNum = Math.ceil((addMinutes / 10) * person._moveSpeed);\r\n        //这边暂时不使用三角函数计算，减少计算量\r\n        let disX = Math.abs(person._goalCityMapPos.x - person._nowMapPos.x);\r\n        let disY = Math.abs(person._goalCityMapPos.y - person._nowMapPos.y);\r\n        let addX = disX / (disX + disY) * moveNum;\r\n        let addY = disY / (disX + disY) * moveNum;\r\n        //x距离增加\r\n        if (person._goalCityMapPos.x !== person._nowMapPos.x) {\r\n            if (person._goalCityMapPos.x > person._nowMapPos.x) {\r\n                person._nowMapPos.x = person._nowMapPos.x + addX;\r\n                if (person._nowMapPos.x >= person._goalCityMapPos.x) {\r\n                    person._nowMapPos.x = person._goalCityMapPos.x;\r\n                }\r\n            } else {\r\n                person._nowMapPos.x = person._nowMapPos.x - addX;\r\n                if (person._nowMapPos.x <= person._goalCityMapPos.x) {\r\n                    person._nowMapPos.x = person._goalCityMapPos.x;\r\n                }\r\n            }\r\n        }\r\n        //y距离增加\r\n        if (person._goalCityMapPos.y !== person._nowMapPos.y) {\r\n            if (person._goalCityMapPos.y > person._nowMapPos.y) {\r\n                person._nowMapPos.y = person._nowMapPos.x + addY;\r\n                if (person._nowMapPos.y >= person._goalCityMapPos.y) {\r\n                    person._nowMapPos.y = person._goalCityMapPos.y;\r\n                }\r\n            } else {\r\n                person._nowMapPos.y = person._nowMapPos.y - addY;\r\n                if (person._nowMapPos.y <= person._goalCityMapPos.y) {\r\n                    person._nowMapPos.y = person._goalCityMapPos.y;\r\n                }\r\n            }\r\n        }\r\n        if (g_GameTool.judgeEqualPos(person._nowMapPos, person._goalCityMapPos)) {\r\n            person._pos.cityId = person._goalCityId;\r\n            person._nowMapPos = person._goalCityMapPos;\r\n            person._goalCityMapPos = undefined;\r\n            person._goalCityId = undefined;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * 没有任务的时候会去判断下一步应该执行什么任务\r\n */\r\nlocal.judgeNextAction = (person) => {\r\n    if (person._itemArr.length > g_GlobalData.MAX_ITEM_NUM) {\r\n        return ActionFactory.createOneAction(5);\r\n    }\r\n    if (person._power < g_GlobalData.MAX_POWER / 2) {\r\n        //睡觉\r\n        return (cc.random0To1() < 0.5) ? ActionFactory.createOneAction(3) : ActionFactory.createOneAction(4);\r\n    } else {\r\n        return (cc.random0To1() < 0.5) ? ActionFactory.createOneAction(1) : ActionFactory.createOneAction(2);\r\n    }\r\n};\r\n\r\n/**\r\n * @param person 已经加好数据的人物，再增加一些操作函数\r\n */\r\nlocal.buildFunc = function (person) {\r\n    //前往一个地点\r\n    person.goToCity = function (cityId) {\r\n        if (person._inInBattle) {\r\n            return;\r\n        }\r\n        let cityMapPos = g_GameGlobalManager.gameData.getCityById(cityId)._cityPos;\r\n        if (g_GameTool.judgeEqualPos(cityMapPos, person._goalCityMapPos)) {\r\n            //修正一下\r\n            person._pos.cityId = cityId;\r\n            return;\r\n        }\r\n        //TODO 改变目的地，这个距离会在时间更新处进行计算\r\n        person._goalCityMapPos = cityMapPos;\r\n        person._goalCityId = cityId;\r\n        //如果当前有大地图坐标的话就以这个数据为出发点，否则使用当前城市的大地图坐标为出发点\r\n        if (person._pos.cityId !== -1) {\r\n            person._nowMapPos = g_GameGlobalManager.gameData.getCityById(person._pos.cityId)._cityPos;\r\n        }\r\n        //立马出城\r\n        person._pos.cityId = -1;\r\n    };\r\n    //前往一个设施\r\n    person.goToBuilding = function (buildingId) {\r\n        if (person._inInBattle) {\r\n            return;\r\n        }\r\n        if (buildingId === -1) {\r\n            //自宅\r\n            if (person._pos.cityId === person._homePos) {\r\n                person._pos.buildingId = buildingId;\r\n                return;\r\n            }\r\n        }\r\n        let nearCityData = g_GameTool.getNearBuildingCity(buildingId, person._pos.cityId, undefined, person);\r\n        if (nearCityData._id !== person._pos.cityId) {\r\n            person.goToCity(nearCityData._id);\r\n            return;\r\n        }\r\n        //城市内的建筑是立马到达的\r\n        person._pos.buildingId = buildingId;\r\n    };\r\n    //任务完成的回调\r\n    person.actionFinishCb = function (action) {\r\n        //表示任务执行完了\r\n        person._nowAction = undefined;\r\n        person.getItem(action._rewardArr);\r\n        //TODO 要不要修改成实时的改变，中间人物可以停止\r\n        person._power = person._power - action._costPower;\r\n        person._money = person._money - action._costMoney || 0;\r\n        if (person._power < 0) {\r\n            person._power = 0;\r\n            g_LogTool.showLog(`${person._name} power error, action is ${action._name}`);\r\n        }\r\n        if (person._money < 0) {\r\n            person._money = 0;\r\n            g_LogTool.showLog(`${person._name} money error, action is ${action._name}`);\r\n        }\r\n    };\r\n    //获得了物品\r\n    person.getItem = function (rewardArr) {\r\n        let i, j;\r\n        for (i = 0; i < rewardArr.length; i++) {\r\n            let id = rewardArr[i];\r\n            let num = rewardArr[i + 1];\r\n            for (j = 0; j < num; j++) {\r\n                let sellData = SellGoodFactory.createOneSellGood(id, undefined, person);\r\n                person._itemArr.push(sellData);\r\n            }\r\n            i++;\r\n        }\r\n    };\r\n    //时间变化函数\r\n    person.timeUpdate = function (addMinutes) {\r\n        if (person._inInBattle) {\r\n            return;\r\n        }\r\n        if (person._nowAction) {\r\n            //执行动作\r\n            g_LogTool.showLog(`${person._name} 正在执行 ${person._nowAction._name}`);\r\n            if (person._nowAction.doAction(person)) {\r\n                person._nowAction.timeUpdate(person, addMinutes);\r\n            }\r\n        } else {\r\n            person._nowAction = local.judgeNextAction(person);\r\n            g_LogTool.showLog(`${person._name} 开始执行 ${person._nowAction._name}`);\r\n            if (person._nowAction.doAction(person)) {\r\n                person._nowAction.timeUpdate(person, addMinutes);\r\n            }\r\n        }\r\n        local.changeMapPos(person, addMinutes);\r\n    };\r\n    //日期变化函数\r\n    person.dayUpdate = function () {\r\n        person._itemArr.forEach(function (oneSellGoodData) {\r\n            if (oneSellGoodData.dayUpdate) {\r\n                oneSellGoodData.dayUpdate(person);\r\n            }\r\n        });\r\n    };\r\n    //获取一个标记物品的id\r\n    person.getNewItemId = function () {\r\n        person._maxItemId++;\r\n        return person._maxItemId - 1;\r\n    };\r\n    //移除一个物品\r\n    person.removeItemByItemId = function (itemId) {\r\n        let i, len, index;\r\n        for (i = 0, len = person._itemArr.length; i < len; i++) {\r\n            if (person._itemArr[i]._itemId === itemId) {\r\n                index = i;\r\n                person._itemArr.splice(index, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    //出售指定id的商品，没有指定的话表示全部\r\n    person.sellGood = function (itemId) {\r\n        if (!itemId) {\r\n            //出售全部\r\n            person._itemArr.forEach((oneItemData) => {\r\n                oneItemData.sell(person);\r\n            });\r\n            person._itemArr = [];\r\n            return;\r\n        }\r\n        let i, len, index;\r\n        for (i = 0, len = person._itemArr.length; i < len; i++) {\r\n            if (person._itemArr[i]._itemId === itemId) {\r\n                index = i;\r\n                person._itemArr[i].sell(person);\r\n                person._itemArr.splice(index, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    //获取存储的数据\r\n    person.getSaveData = function () {\r\n        return {\r\n            name: person._name,\r\n            attack: person._attack,\r\n            def: person._def,\r\n            command: person._command,\r\n            intelligence: person._intelligence,\r\n            charm: person._charm,\r\n            politics: person._politics,\r\n            maxHp: person._maxHp,\r\n            sex: person._sex,\r\n            moveSpeed: person._moveSpeed,\r\n            presonSkillId: person._presonSkillId,\r\n            battleSkillId: person._battleSkillId,\r\n            equipAttack: person._equipAttack,\r\n            equipDef: person._equipDef,\r\n            equipJewelry: person._equipJewelry,\r\n            equipHorse: person._equipHorse,\r\n            nowHp: person._nowHp,\r\n            id: person._id,\r\n            pos: person._pos,\r\n            homePos: person._homePos,\r\n            goalCityMapPos: person._goalCityMapPos,\r\n            nowMapPos: person._nowMapPos,\r\n            goalCityId: person._goalCityId,\r\n            nowAction: person._nowAction ? person._nowAction.getSaveData() : undefined,\r\n            itemArr: person._itemArr.map(function (oneItemData) {\r\n                return oneItemData.getSaveData();\r\n            }),\r\n            money: person._money,\r\n            power: person._power,\r\n            maxItemId: person._maxItemId\r\n        }\r\n    };\r\n    //死亡回调\r\n    /**\r\n     * @param personAttack 击杀者\r\n     */\r\n    person.deadCb = function (personAttack) {\r\n        g_LogTool.showLog(`${personAttack._name} 击杀了 ${person._name}`);\r\n    };\r\n    //开始战斗的回调\r\n    person.startBattleCb = function () {\r\n        person._inInBattle = true;\r\n    };\r\n    //战斗结束回调\r\n    person.battleFinishCb = function () {\r\n        if (person._nowHp < g_GlobalData.MIN_HP_NUM * person._maxHp) {\r\n            person.treat();\r\n        }\r\n        person._inInBattle = false;\r\n    };\r\n    //回复血量\r\n    person.treat = function () {\r\n        let i, len = person._itemArr.length;\r\n        for (i = 0; i < len; i++) {\r\n            if (person._itemArr[i].judgeHaveFunctionByName('treat')) {\r\n                person._itemArr[i].use();\r\n            }\r\n            if (person._nowHp >= person._maxHp) {\r\n                break;\r\n            }\r\n        }\r\n        if (person._nowHp < g_GlobalData.MIN_HP_NUM * person._maxHp) {\r\n            //这个时候增加一个医馆行动\r\n            let action = ActionFactory.createOneAction(6);\r\n            if (action._costMoney > person._money) {\r\n                this._nowAction = ActionFactory.createOneAction(4);\r\n            } else {\r\n                this._nowAction = action;\r\n            }\r\n        } else {\r\n            g_LogTool.showLog(`${person._name} 使用食物治疗结束`);\r\n        }\r\n    };\r\n    //触发大地图随机事件\r\n    person.mapRandomEventCb = function () {\r\n\r\n    };\r\n    //使用自宅\r\n    person.useHome = function () {\r\n        person._nowHp = person._maxHp;\r\n        g_LogTool.showLog(`${person._name} 在家休息结束`);\r\n    };\r\n};\r\n\r\n/**\r\n * @param personId 初始化一个角色，这个是新建一个角色\r\n * @param randomData 随机数据\r\n */\r\nlocal.createOneBasePerson = function (personId, randomData, cityId) {\r\n    //先定义数据，方便查找\r\n    //this._personId = parseInt(personId);\r\n    //配置数据\r\n    var jsonData = randomData || g_JsonDataTool.getDataById('_table_person_person', personId);\r\n    //名字\r\n    this._name = jsonData.name;\r\n    //攻击力\r\n    this._attack = jsonData.attack;\r\n    //防御力\r\n    this._def = jsonData.def;\r\n    //统帅\r\n    this._command = jsonData.command;\r\n    //智力\r\n    this._intelligence = jsonData.intelligence;\r\n    //魅力\r\n    this._charm = jsonData.charm;\r\n    //政治\r\n    this._politics = jsonData.politics;\r\n    //生命值\r\n    this._maxHp = jsonData.hp;\r\n    //性别\r\n    this._sex = jsonData.sex;\r\n    //大地图移动速度\r\n    this._moveSpeed = jsonData.moveSpeed;\r\n    //个人技能\r\n    this._presonSkillId = jsonData.presonSkillId || 1;\r\n    //TODO 需要新建一个技能\r\n\r\n    //战争技能\r\n    this._battleSkillId = jsonData.battleSkillId || 1;\r\n    //TODO 需要新建一个技能\r\n\r\n    //这边是存储的配置\r\n    //武器装备\r\n    this._equipAttack = undefined;\r\n    //防御装备\r\n    this._equipDef = undefined;\r\n    //首饰\r\n    this._equipJewelry = undefined;\r\n    //坐骑\r\n    this._equipHorse = undefined;\r\n    //血量\r\n    this._nowHp = this._maxHp;\r\n    //唯一id\r\n    this._id = g_GameGlobalManager.getNewPersonId();\r\n    //位置\r\n    //初始都是在家的\r\n    this._pos = {\r\n        cityId: cityId || 0,\r\n        buildingId: -1\r\n    };\r\n    //家的位置，是一个城市id\r\n    this._homePos = cityId || 0;\r\n    //目的地的大地图坐标\r\n    this._goalCityMapPos = undefined;\r\n    //当前人物所在的大地图坐标\r\n    this._nowMapPos = undefined;\r\n    //目标城市的id\r\n    this._goalCityId = undefined;\r\n    //当前执行的任务\r\n    this._nowAction = undefined;\r\n    //当前的人物的物品数据\r\n    this._itemArr = [];\r\n    //货币数量\r\n    this._money = 0;\r\n    //体力\r\n    this._power = g_GlobalData.MAX_POWER;\r\n    //标记物品id的最大值\r\n    this._maxItemId = 1;\r\n    //是否在战斗中\r\n    //暂定是不记录战斗信息\r\n    this._inInBattle = false;\r\n\r\n    local.buildFunc(this);\r\n};\r\n\r\n/**\r\n * @param saveData 根据存储的数据生成一个角色\r\n */\r\nlocal.createOneBasePersonBySaveData = function (saveData) {\r\n    //名字\r\n    this._name = saveData.name;\r\n    //攻击力\r\n    this._attack = saveData.attack || 0;\r\n    //防御力\r\n    this._def = saveData.def;\r\n    //统帅\r\n    this._command = saveData.command;\r\n    //智力\r\n    this._intelligence = saveData.intelligence;\r\n    //魅力\r\n    this._charm = saveData.charm;\r\n    //政治\r\n    this._politics = saveData.politics;\r\n    //生命值\r\n    this._maxHp = saveData.maxHp;\r\n    //性别\r\n    this._sex = saveData.sex;\r\n    //大地图移动速度\r\n    this._moveSpeed = saveData.moveSpeed;\r\n    //个人技能\r\n    this._presonSkillIdArr = saveData.presonSkillId ? ('' + saveData.presonSkillId).split(',') : [];\r\n    //TODO 需要新建一个技能\r\n\r\n    //战争技能\r\n    this._battleSkillIdArr = saveData.battleSkillId ? ('' + saveData.battleSkillId).split(',') : [];\r\n    //TODO 需要新建一个技能\r\n\r\n    //这边是存储的配置\r\n    //武器装备\r\n    this._equipAttack = saveData.equipAttack;\r\n    //防御装备\r\n    this._equipDef = saveData.equipDef;\r\n    //首饰\r\n    this._equipJewelry = saveData.equipJewelry;\r\n    //坐骑\r\n    this._equipHorse = saveData.equipHorse;\r\n    //血量\r\n    this._nowHp = saveData.nowHp;\r\n    //唯一id\r\n    this._id = saveData.id;\r\n    //位置\r\n    //初始都是在家的\r\n    this._pos = saveData.pos;\r\n    //家的位置，是一个城市id\r\n    this._homePos = saveData.homePos;\r\n    //目的地\r\n    this._goalCityMapPos = saveData.goalCityMapPos;\r\n    //到目的地的剩余的距离\r\n    this._nowMapPos = saveData.nowMapPos;\r\n    //目标城市的id\r\n    this._goalCityId = saveData.goalCityId;\r\n    //当前执行的任务\r\n    this._nowAction = saveData.nowAction ? ActionFactory.createOneAction(undefined, saveData.nowAction) : undefined;\r\n    //当前的人物的物品数据\r\n    this._itemArr = saveData.itemArr.map(function (oenData) {\r\n        return SellGoodFactory.createOneSellGood(undefined, oenData, undefined);\r\n    });\r\n    //货币数量\r\n    this._money = saveData.money;\r\n    //体力\r\n    this._power = saveData.power;\r\n    //标记物品id的最大值\r\n    this._maxItemId = saveData.maxItemId;\r\n    //是否在战斗中\r\n    //暂定是不记录战斗信息\r\n    this._inInBattle = false;\r\n\r\n    local.buildFunc(this);\r\n};\r\n\r\n/**\r\n * 新建一个随机人物\r\n * @param sex 性别\r\n */\r\noutModule.createRandomPerson = (sex, cityId) => {\r\n    var randomData = {};\r\n    //默认是男性\r\n    randomData.sex = sex || g_GlobalData.SEX_MAN;\r\n    randomData.name = RandomNameTool.getRandomName(randomData.sex);\r\n    //随机数据\r\n    randomData.attack = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.def = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.command = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.intelligence = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.charm = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.politics = 40 + Math.ceil(cc.random0To1() * 60);\r\n    randomData.hp = 600 + Math.ceil(cc.random0To1() * 400);\r\n    randomData.moveSpeed = 5;\r\n    return new local.createOneBasePerson(undefined, randomData, cityId);\r\n};\r\n\r\n/**\r\n * @param personId 人物id\r\n * @param saveData 存储数据\r\n * @param cityId 出生地\r\n */\r\noutModule.createOneBasePerson = (personId, saveData, cityId) => {\r\n    if (saveData) {\r\n        return new local.createOneBasePersonBySaveData(saveData);\r\n    }\r\n    return new local.createOneBasePerson(personId, undefined, cityId);\r\n};\r\n\r\nmodule.exports = outModule;"]}