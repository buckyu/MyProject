{"version":3,"sources":["UserBuildUI.js"],"names":["BaseUI","require","RandomNameTool","UserRoleFactory","cc","Class","extends","properties","_uiName","_randomNameLabelNode","_randomSexToggleNode","_randomAttackLabelNode","_randomDefLabelNode","_randomCommandLabelNode","_randomIntelligenceLabelNode","_randomCharmLabelNode","_randomPoliticsLabelNode","_randomHpLabelNode","_randomName","_randomSex","onLoad","_super","onUIInit","find","_topNode","getComponent","EditBox","placeholder","g_LanguageTool","getLanguageStr","ToggleContainer","toggleItems","forEach","oneToggleComponent","node","on","event","target","name","g_GlobalData","SEX_MAN","SEX_WOMAN","updateSexToggle","bind","onButtonClick","component","lastName","getRandomName","updateRandomName","removeOneName","_randomUserRoleData","createUserRole","undefined","getRandomUserRoleData","updateRandomNum","g_GameGlobalManager","userRole","g_GameSceneManager","addNode","g_GAME_SCENE_UI_NODE","hide","onShow","deleteFlag","onDestroy","randomName","string","randomData","Label","_attack","_def","_command","_intelligence","_charm","_politics","_maxHp","selectSex","isChecked"],"mappings":"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","file":"UserBuildUI.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\UserBuildUI","sourcesContent":["/*global module, require, cc, client */\r\n/**\r\n * @desc 模块描述\r\n * @author Administrator\r\n */\r\nvar BaseUI = require('BaseUI');\r\nvar RandomNameTool = require('RandomNameTool');\r\nvar UserRoleFactory = require('UserRoleFactory');\r\ncc.Class({\r\n    extends: BaseUI,\r\n\r\n    properties: {\r\n        _uiName: 'UserBuildUI',\r\n        _randomNameLabelNode: null,\r\n        _randomSexToggleNode: null,\r\n        _randomAttackLabelNode: null,\r\n        _randomDefLabelNode: null,\r\n        _randomCommandLabelNode: null,\r\n        _randomIntelligenceLabelNode: null,\r\n        _randomCharmLabelNode: null,\r\n        _randomPoliticsLabelNode: null,\r\n        _randomHpLabelNode: null,\r\n        _randomName: null,\r\n        _randomSex: null\r\n    },\r\n\r\n    onLoad() {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * UI界面显示\r\n     * @constructor\r\n     */\r\n    onUIInit: function () {\r\n        this._super();\r\n        this._randomNameLabelNode = cc.find('Name/random_name', this._topNode);\r\n        this._randomNameLabelNode.getComponent(cc.EditBox).placeholder = g_LanguageTool.getLanguageStr('random_name_notice');\r\n        this._randomSexToggleNode = cc.find('Sex/toggleContainer', this._topNode);\r\n        this._randomSexToggleNode.getComponent(cc.ToggleContainer).toggleItems.forEach(function (oneToggleComponent) {\r\n            //监听事件\r\n            oneToggleComponent.node.on('toggle', function (event) {\r\n                if (event.target.name === 'toggle_man') {\r\n                    this._randomSex = g_GlobalData.SEX_MAN;\r\n                } else {\r\n                    this._randomSex = g_GlobalData.SEX_WOMAN;\r\n                }\r\n                this.updateSexToggle(this._randomSex);\r\n            }.bind(this));\r\n        }.bind(this));\r\n        //随机属性控件相关\r\n        this._randomAttackLabelNode = cc.find('Attack/Attack', this._topNode);\r\n        this._randomDefLabelNode = cc.find('Def/Def', this._topNode);\r\n        this._randomCommandLabelNode = cc.find('Command/Command', this._topNode);\r\n        this._randomIntelligenceLabelNode = cc.find('Intelligence/Intelligence', this._topNode);\r\n        this._randomCharmLabelNode = cc.find('Charm/Charm', this._topNode);\r\n        this._randomPoliticsLabelNode = cc.find('Politics/Politics', this._topNode);\r\n        this._randomHpLabelNode = cc.find('Hp/Hp', this._topNode);\r\n    },\r\n\r\n    /**\r\n     * 实现方法，点击回调\r\n     */\r\n    onButtonClick: function (name, node, component) {\r\n        switch (name) {\r\n            case 'random_btn':\r\n                var lastName = this._randomName;\r\n                //新建一个名字\r\n                this._randomName = RandomNameTool.getRandomName(this._randomSex);\r\n                this.updateRandomName(this._randomName);\r\n                RandomNameTool.removeOneName(lastName);\r\n                break;\r\n            case 'random':\r\n                this._randomUserRoleData = UserRoleFactory.createUserRole(undefined,\r\n                    UserRoleFactory.getRandomUserRoleData(this._randomSex, this._randomName));\r\n                this.updateRandomNum(this._randomUserRoleData);\r\n                break;\r\n            case 'sure':\r\n                g_GameGlobalManager.userRole = this._randomUserRoleData;\r\n                //加载MainUI界面\r\n                g_GameSceneManager.addNode('Prefab/MainUI/MainUI', g_GAME_SCENE_UI_NODE, 'MainUI',\r\n                    false, undefined, undefined, 100);\r\n                //直接销毁了，这个界面没用了\r\n                this.hide(true);\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * UI界面显示\r\n     * @constructor\r\n     */\r\n    onShow: function () {\r\n        this._super();\r\n        //先初始化随机名字\r\n        this._randomName = RandomNameTool.getRandomName(g_GlobalData.SEX_MAN);\r\n        this.updateRandomName(this._randomName);\r\n        //初始化性别\r\n        //初始化默认都是男性\r\n        this._randomSex = g_GlobalData.SEX_MAN;\r\n        this.updateSexToggle(this._randomSex);\r\n        //初始化一个数据\r\n        this._randomUserRoleData = UserRoleFactory.createUserRole(undefined,\r\n            UserRoleFactory.getRandomUserRoleData(this._randomSex, this._randomName));\r\n        this.updateRandomNum(this._randomUserRoleData);\r\n    },\r\n\r\n    /**\r\n     * UI隐藏\r\n     * @constructor\r\n     */\r\n    hide: function (deleteFlag) {\r\n        this._super(deleteFlag);\r\n    },\r\n\r\n    /**\r\n     * UI销毁\r\n     * @constructor\r\n     */\r\n    onDestroy: function () {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * 更新名字显示控件\r\n     * @param randomName\r\n     */\r\n    updateRandomName: function (randomName) {\r\n        this._randomNameLabelNode.getComponent(cc.EditBox).string = randomName;\r\n    },\r\n\r\n\r\n    /**\r\n     * 显示随机数据\r\n     * @param randomData\r\n     */\r\n    updateRandomNum: function (randomData) {\r\n        this._randomAttackLabelNode.getComponent(cc.Label).string = randomData._attack;\r\n        this._randomDefLabelNode.getComponent(cc.Label).string = randomData._def;\r\n        this._randomCommandLabelNode.getComponent(cc.Label).string = randomData._command;\r\n        this._randomIntelligenceLabelNode.getComponent(cc.Label).string = randomData._intelligence;\r\n        this._randomCharmLabelNode.getComponent(cc.Label).string = randomData._charm;\r\n        this._randomPoliticsLabelNode.getComponent(cc.Label).string = randomData._politics;\r\n        this._randomHpLabelNode.getComponent(cc.Label).string = randomData._maxHp;\r\n    },\r\n\r\n    /**\r\n     * 更新性别控件的显示\r\n     * @param selectSex 选择的性别\r\n     */\r\n    updateSexToggle: function (selectSex) {\r\n        selectSex = selectSex || g_GlobalData.SEX_MAN;\r\n        //先更新选中情况\r\n        this._randomSexToggleNode.getComponent(cc.ToggleContainer).toggleItems.forEach(function (oneToggleComponent) {\r\n            if (oneToggleComponent.node.name === 'toggle_man') {\r\n                oneToggleComponent.isChecked = selectSex === g_GlobalData.SEX_MAN;\r\n            } else {\r\n                oneToggleComponent.isChecked = selectSex !== g_GlobalData.SEX_MAN;\r\n            }\r\n        });\r\n        //更新显示字符\r\n        cc.find('Sex/random_sex', this._topNode).getComponent(cc.Label).string =\r\n            selectSex === g_GlobalData.SEX_MAN ? g_LanguageTool.getLanguageStr('sex_man') : g_LanguageTool.getLanguageStr('sex_woman');\r\n    }\r\n});\r\n"]}