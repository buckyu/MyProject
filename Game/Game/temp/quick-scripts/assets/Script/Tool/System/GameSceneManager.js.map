{"version":3,"sources":["GameSceneManager.js"],"names":["outModule","addNode","prefabPath","parentNodeType","nodeName","addMoreFlag","successCb","failCb","frequency","parentNode","g_GAME_SCENE_UI_NODE","g_GameScene","UINode","undefined","g_GAME_SCENE_ALERT_NODE","AlertNode","g_GAME_SCENE_NET_NODE","NetNode","node","getChildByName","removeFromParent","addChild","active","_components","forEach","oneComponent","onShow","newNode","cc","instantiate","_tj_prefabPath","name","g_PrefabManager","addPrefabNode","loadPrefab","prefab","err","module","exports"],"mappings":";;;;;;AAAA;AACA;;;;;;;AAOA,IAAIA,YAAY,EAAhB;;AAEA;;;;;;;;;;AAUAA,UAAUC,OAAV,GAAoB,UAACC,UAAD,EAAaC,cAAb,EAA6BC,QAA7B,EAAuCC,WAAvC,EAAoDC,SAApD,EAA+DC,MAA/D,EAAuEC,SAAvE,EAAqF;AACrG;AACA,QAAIC,mBAAJ;AACA;AACA,YAAQN,cAAR;AACI,aAAKO,oBAAL;AACID,yBAAaE,cAAcA,YAAYC,MAA1B,GAAmCC,SAAhD;AACA;AACJ,aAAKC,uBAAL;AACIL,yBAAaE,cAAcA,YAAYI,SAA1B,GAAsCF,SAAnD;AACA;AACJ,aAAKG,qBAAL;AACIP,yBAAaE,cAAcA,YAAYM,OAA1B,GAAoCJ,SAAjD;AACA;AATR;AAWA,QAAI,CAACJ,UAAL,EAAiB;AACb;AACH;AACD;AACA,QAAIS,OAAOT,WAAWU,cAAX,CAA0Bf,QAA1B,CAAX;AACA,QAAIc,IAAJ,EAAU;AACN,YAAI,CAACb,WAAL,EAAkB;AACd;AACAa,iBAAKE,gBAAL,CAAsB,KAAtB;AACAX,uBAAWY,QAAX,CAAoBH,IAApB;AACAA,iBAAKI,MAAL,GAAc,IAAd;AACA;AACA,gBAAIJ,KAAKK,WAAT,EAAsB;AAClBL,qBAAKK,WAAL,CAAiBC,OAAjB,CAAyB,UAAUC,YAAV,EAAwB;AAC7C,wBAAIA,gBAAgBA,aAAaC,MAAjC,EAAyC;AACrCD,qCAAaC,MAAb;AACH;AACJ,iBAJD;AAKH;AACD,gBAAIpB,SAAJ,EAAe;AACXA;AACH;AACJ,SAhBD,MAgBO;AACH;AACA,gBAAIqB,UAAUC,GAAGC,WAAH,CAAeX,IAAf,CAAd;AACAS,oBAAQG,cAAR,GAAyB5B,UAAzB;AACAyB,oBAAQI,IAAR,GAAe3B,QAAf;AACAK,uBAAWY,QAAX,CAAoBM,OAApB;AACAK,4BAAgBC,aAAhB,CAA8B/B,UAA9B,EAA0CyB,OAA1C;AACA,gBAAIrB,SAAJ,EAAe;AACXA;AACH;AACJ;AACD;AACH;AACD;AACA0B,oBAAgBE,UAAhB,CAA2BhC,UAA3B,EAAuC,UAACiC,MAAD,EAAY;AAC/C,YAAIjB,OAAOU,GAAGC,WAAH,CAAeM,MAAf,CAAX;AACAjB,aAAKY,cAAL,GAAsB5B,UAAtB;AACAgB,aAAKa,IAAL,GAAY3B,QAAZ;AACAK,mBAAWY,QAAX,CAAoBH,IAApB;AACAc,wBAAgBC,aAAhB,CAA8B/B,UAA9B,EAA0CgB,IAA1C;AACA,YAAIZ,SAAJ,EAAe;AACXA;AACH;AACJ,KATD,EASG,UAAC8B,GAAD,EAAS;AACR;AACA,YAAI7B,MAAJ,EAAY;AACRA,mBAAO6B,GAAP;AACH;AACJ,KAdD,EAcG5B,SAdH;AAeH,CAlED;;AAoEA6B,OAAOC,OAAP,GAAiBtC,SAAjB","file":"GameSceneManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Tool\\System","sourcesContent":["/*global module, require, cc, client */\r\n/**\r\n * @desc Game场景管理器，Game场景里面有三个根节点\r\n * UINode:所有的UI界面放在这个下面\r\n * AlertNode:所有的提示界面\r\n * NetNode:网络延迟转圈界面\r\n * @author Administrator\r\n */\r\nvar outModule = {};\r\n\r\n/**\r\n * 加载一个预制体增加到Game场景下三个根节点中\r\n * @param {String} prefabPath 预制件的路径\r\n * @param {Number} parentNodeType 所加入的节点的类型\r\n * @param {Boolean} addMoreFlag 是否允许添加多个结点，默认一个名字的结点只能添加一次\r\n * @param {String} nodeName 新节点的名字\r\n * @param {Function} successCb\r\n * @param {Function} failCb\r\n * @param {Number} frequency\r\n */\r\noutModule.addNode = (prefabPath, parentNodeType, nodeName, addMoreFlag, successCb, failCb, frequency) => {\r\n    //要加入到的结点\r\n    let parentNode;\r\n    //确定要加入的结点\r\n    switch (parentNodeType) {\r\n        case g_GAME_SCENE_UI_NODE:\r\n            parentNode = g_GameScene ? g_GameScene.UINode : undefined;\r\n            break;\r\n        case g_GAME_SCENE_ALERT_NODE:\r\n            parentNode = g_GameScene ? g_GameScene.AlertNode : undefined;\r\n            break;\r\n        case g_GAME_SCENE_NET_NODE:\r\n            parentNode = g_GameScene ? g_GameScene.NetNode : undefined;\r\n            break;\r\n    }\r\n    if (!parentNode) {\r\n        return;\r\n    }\r\n    //判断有没有同名的结点\r\n    let node = parentNode.getChildByName(nodeName);\r\n    if (node) {\r\n        if (!addMoreFlag) {\r\n            //不允许添加多个的时候，把这个结点置顶并显示\r\n            node.removeFromParent(false);\r\n            parentNode.addChild(node);\r\n            node.active = true;\r\n            //判断有没有onShow函数\r\n            if (node._components) {\r\n                node._components.forEach(function (oneComponent) {\r\n                    if (oneComponent && oneComponent.onShow) {\r\n                        oneComponent.onShow();\r\n                    }\r\n                });\r\n            }\r\n            if (successCb) {\r\n                successCb();\r\n            }\r\n        } else {\r\n            //直接复制一个\r\n            let newNode = cc.instantiate(node);\r\n            newNode._tj_prefabPath = prefabPath;\r\n            newNode.name = nodeName;\r\n            parentNode.addChild(newNode);\r\n            g_PrefabManager.addPrefabNode(prefabPath, newNode);\r\n            if (successCb) {\r\n                successCb();\r\n            }\r\n        }\r\n        return;\r\n    }\r\n    //判断有没有这个结点\r\n    g_PrefabManager.loadPrefab(prefabPath, (prefab) => {\r\n        var node = cc.instantiate(prefab);\r\n        node._tj_prefabPath = prefabPath;\r\n        node.name = nodeName;\r\n        parentNode.addChild(node);\r\n        g_PrefabManager.addPrefabNode(prefabPath, node);\r\n        if (successCb) {\r\n            successCb();\r\n        }\r\n    }, (err) => {\r\n        //失败回调\r\n        if (failCb) {\r\n            failCb(err);\r\n        }\r\n    }, frequency);\r\n};\r\n\r\nmodule.exports = outModule;"]}